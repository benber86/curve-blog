const histogramData =
    {
        'ethereum': {
            'Trading': [{'label': '$0.00 - $3.2k', 'value': 15180},
                {'label': '$3.2k - $6.5k', 'value': 1965},
                {'label': '$6.5k - $9.7k', 'value': 967},
                {'label': '$9.7k - $12.9k', 'value': 869},
                {'label': '$12.9k - $16.2k', 'value': 450},
                {'label': '$16.2k - $19.4k', 'value': 235},
                {'label': '$19.4k - $22.6k', 'value': 406},
                {'label': '$22.6k - $25.9k', 'value': 226},
                {'label': '$25.9k - $29.1k', 'value': 146},
                {'label': '$29.1k - $11.2b', 'value': 4640}],
            'LP': [{'label': '$0.00 - $2.7k', 'value': 16226},
                {'label': '$2.7k - $5.3k', 'value': 3457},
                {'label': '$5.3k - $8.0k', 'value': 2002},
                {'label': '$8.0k - $10.6k', 'value': 1092},
                {'label': '$10.6k - $13.3k', 'value': 665},
                {'label': '$13.3k - $16.0k', 'value': 542},
                {'label': '$16.0k - $18.6k', 'value': 336},
                {'label': '$18.6k - $21.3k', 'value': 454},
                {'label': '$21.3k - $23.9k', 'value': 228},
                {'label': '$23.9k - $594.4m', 'value': 4738}],
            'UI Router': [{'label': '$0.00 - $8.7k', 'value': 14173},
                {'label': '$8.7k - $17.4k', 'value': 2205},
                {'label': '$17.4k - $26.1k', 'value': 1117},
                {'label': '$26.1k - $34.8k', 'value': 755},
                {'label': '$34.8k - $43.5k', 'value': 523},
                {'label': '$43.5k - $52.2k', 'value': 471},
                {'label': '$52.2k - $60.9k', 'value': 363},
                {'label': '$60.9k - $69.6k', 'value': 276},
                {'label': '$69.6k - $78.3k', 'value': 260},
                {'label': '$78.3k - $359.0m', 'value': 3931}],
            'crvUSD': [{'label': '$0.04 - $506.3k', 'value': 1524},
                {'label': '$506.3k - $1.0m', 'value': 255},
                {'label': '$1.0m - $1.5m', 'value': 174},
                {'label': '$1.5m - $2.0m', 'value': 111},
                {'label': '$2.0m - $2.5m', 'value': 93},
                {'label': '$2.5m - $3.0m', 'value': 55},
                {'label': '$3.0m - $3.5m', 'value': 36},
                {'label': '$3.5m - $4.1m', 'value': 33},
                {'label': '$4.1m - $4.6m', 'value': 28},
                {'label': '$4.6m - $9.0b', 'value': 387}],
            'Lend': [{'label': '$12.73 - $229.9k', 'value': 199},
                {'label': '$229.9k - $459.8k', 'value': 22},
                {'label': '$459.8k - $689.7k', 'value': 16},
                {'label': '$689.7k - $919.7k', 'value': 11},
                {'label': '$919.7k - $1.1m', 'value': 3},
                {'label': '$1.1m - $1.4m', 'value': 8},
                {'label': '$1.4m - $1.6m', 'value': 2},
                {'label': '$1.6m - $1.8m', 'value': 6},
                {'label': '$1.8m - $2.1m', 'value': 5},
                {'label': '$2.1m - $6.8b', 'value': 58}]
        },
        'fantom': {
            'Trading': [{'label': '$0.00 - $113.20', 'value': 304},
                {'label': '$113.20 - $226.40', 'value': 23},
                {'label': '$226.40 - $339.60', 'value': 16},
                {'label': '$339.60 - $452.80', 'value': 9},
                {'label': '$452.80 - $565.99', 'value': 10},
                {'label': '$565.99 - $679.19', 'value': 7},
                {'label': '$679.19 - $792.39', 'value': 4},
                {'label': '$792.39 - $905.59', 'value': 3},
                {'label': '$905.59 - $1.0k', 'value': 4},
                {'label': '$1.0k - $27.5m', 'value': 86}],
            'LP': [{'label': '$0.00 - $321.46', 'value': 139},
                {'label': '$321.46 - $642.93', 'value': 28},
                {'label': '$642.93 - $964.39', 'value': 6},
                {'label': '$964.39 - $1.3k', 'value': 16},
                {'label': '$1.3k - $1.6k', 'value': 5},
                {'label': '$1.6k - $1.9k', 'value': 6},
                {'label': '$1.9k - $2.3k', 'value': 3},
                {'label': '$2.3k - $2.6k', 'value': 1},
                {'label': '$2.6k - $2.9k', 'value': 3},
                {'label': '$2.9k - $3.1m', 'value': 43}],
            'UI Router': [{'label': '$0.00 - $49.49', 'value': 200},
                {'label': '$49.49 - $98.99', 'value': 36},
                {'label': '$98.99 - $148.48', 'value': 23},
                {'label': '$148.48 - $197.97', 'value': 12},
                {'label': '$197.97 - $247.46', 'value': 9},
                {'label': '$247.46 - $296.96', 'value': 4},
                {'label': '$296.96 - $346.45', 'value': 6},
                {'label': '$346.45 - $395.94', 'value': 6},
                {'label': '$395.94 - $445.44', 'value': 4},
                {'label': '$445.44 - $137.4k', 'value': 59}]
        },
        'optimism': {
            'Trading': [{'label': '$0.00 - $34.80', 'value': 453},
                {'label': '$34.80 - $69.60', 'value': 339},
                {'label': '$69.60 - $104.39', 'value': 233},
                {'label': '$104.39 - $139.19', 'value': 159},
                {'label': '$139.19 - $173.99', 'value': 79},
                {'label': '$173.99 - $208.79', 'value': 42},
                {'label': '$208.79 - $243.59', 'value': 31},
                {'label': '$243.59 - $278.39', 'value': 19},
                {'label': '$278.39 - $313.18', 'value': 10},
                {'label': '$313.18 - $153.9m', 'value': 271}],
            'LP': [{'label': '$0.00 - $1.2k', 'value': 1195},
                {'label': '$1.2k - $2.5k', 'value': 73},
                {'label': '$2.5k - $3.7k', 'value': 45},
                {'label': '$3.7k - $4.9k', 'value': 29},
                {'label': '$4.9k - $6.2k', 'value': 27},
                {'label': '$6.2k - $7.4k', 'value': 15},
                {'label': '$7.4k - $8.6k', 'value': 16},
                {'label': '$8.6k - $9.8k', 'value': 16},
                {'label': '$9.8k - $11.1k', 'value': 29},
                {'label': '$11.1k - $113.3m', 'value': 333}],
            'UI Router': [{'label': '$0.00 - $128.28', 'value': 3095},
                {'label': '$128.28 - $256.56', 'value': 267},
                {'label': '$256.56 - $384.83', 'value': 119},
                {'label': '$384.83 - $513.11', 'value': 120},
                {'label': '$513.11 - $641.39', 'value': 86},
                {'label': '$641.39 - $769.67', 'value': 58},
                {'label': '$769.67 - $897.94', 'value': 40},
                {'label': '$897.94 - $1.0k', 'value': 74},
                {'label': '$1.0k - $1.2k', 'value': 31},
                {'label': '$1.2k - $9.9m', 'value': 850}]
        },
        'polygon': {
            'Trading': [{'label': '$0.00 - $1.3k', 'value': 1136},
                {'label': '$1.3k - $2.5k', 'value': 21},
                {'label': '$2.5k - $3.8k', 'value': 27},
                {'label': '$3.8k - $5.0k', 'value': 63},
                {'label': '$5.0k - $6.3k', 'value': 32},
                {'label': '$6.3k - $7.5k', 'value': 30},
                {'label': '$7.5k - $8.8k', 'value': 12},
                {'label': '$8.8k - $10.0k', 'value': 13},
                {'label': '$10.0k - $11.3k', 'value': 13},
                {'label': '$11.3k - $342.4m', 'value': 262}],
            'LP': [{'label': '$0.00 - $40.52', 'value': 2238},
                {'label': '$40.52 - $81.05', 'value': 60},
                {'label': '$81.05 - $121.57', 'value': 51},
                {'label': '$121.57 - $162.10', 'value': 32},
                {'label': '$162.10 - $202.62', 'value': 19},
                {'label': '$202.62 - $243.14', 'value': 22},
                {'label': '$243.14 - $283.67', 'value': 19},
                {'label': '$283.67 - $324.19', 'value': 17},
                {'label': '$324.19 - $364.72', 'value': 13},
                {'label': '$364.72 - $113.4m', 'value': 694}],
            'UI Router': [{'label': '$0.00 - $13.12', 'value': 2759},
                {'label': '$13.12 - $26.24', 'value': 3559},
                {'label': '$26.24 - $39.36', 'value': 2101},
                {'label': '$39.36 - $52.48', 'value': 1354},
                {'label': '$52.48 - $65.60', 'value': 774},
                {'label': '$65.60 - $78.72', 'value': 410},
                {'label': '$78.72 - $91.84', 'value': 247},
                {'label': '$91.84 - $104.96', 'value': 233},
                {'label': '$104.96 - $118.09', 'value': 114},
                {'label': '$118.09 - $13.7m', 'value': 1816}]
        },
        'xdai': {
            'Trading': [{'label': '$0.00 - $838.91', 'value': 316},
                {'label': '$838.91 - $1.7k', 'value': 76},
                {'label': '$1.7k - $2.5k', 'value': 36},
                {'label': '$2.5k - $3.4k', 'value': 23},
                {'label': '$3.4k - $4.2k', 'value': 68},
                {'label': '$4.2k - $5.0k', 'value': 38},
                {'label': '$5.0k - $5.9k', 'value': 1},
                {'label': '$5.9k - $6.7k', 'value': 1},
                {'label': '$6.7k - $7.6k', 'value': 0},
                {'label': '$7.6k - $6.4m', 'value': 35}],
            'LP': [{'label': '$0.00 - $2.4k', 'value': 68},
                {'label': '$2.4k - $4.9k', 'value': 6},
                {'label': '$4.9k - $7.3k', 'value': 4},
                {'label': '$7.3k - $9.8k', 'value': 4},
                {'label': '$9.8k - $12.2k', 'value': 0},
                {'label': '$12.2k - $14.7k', 'value': 1},
                {'label': '$14.7k - $17.1k', 'value': 0},
                {'label': '$17.1k - $19.6k', 'value': 1},
                {'label': '$19.6k - $22.0k', 'value': 2},
                {'label': '$22.0k - $6.6m', 'value': 20}],
            'UI Router': [{'label': '$0.00 - $443.87', 'value': 125},
                {'label': '$443.87 - $887.75', 'value': 27},
                {'label': '$887.75 - $1.3k', 'value': 19},
                {'label': '$1.3k - $1.8k', 'value': 8},
                {'label': '$1.8k - $2.2k', 'value': 6},
                {'label': '$2.2k - $2.7k', 'value': 5},
                {'label': '$2.7k - $3.1k', 'value': 3},
                {'label': '$3.1k - $3.6k', 'value': 4},
                {'label': '$3.6k - $4.0k', 'value': 2},
                {'label': '$4.0k - $244.4k', 'value': 35}]
        },
        'fraxtal': {
            'Trading': [{'label': '$0.00 - $570.21', 'value': 66},
                {'label': '$570.21 - $1.1k', 'value': 7},
                {'label': '$1.1k - $1.7k', 'value': 3},
                {'label': '$1.7k - $2.3k', 'value': 4},
                {'label': '$2.3k - $2.9k', 'value': 2},
                {'label': '$2.9k - $3.4k', 'value': 2},
                {'label': '$3.4k - $4.0k', 'value': 0},
                {'label': '$4.0k - $4.6k', 'value': 0},
                {'label': '$4.6k - $5.1k', 'value': 2},
                {'label': '$5.1k - $2.2m', 'value': 19}],
            'LP': [{'label': '$0.03 - $5.7k', 'value': 149},
                {'label': '$5.7k - $11.4k', 'value': 20},
                {'label': '$11.4k - $17.1k', 'value': 8},
                {'label': '$17.1k - $22.8k', 'value': 10},
                {'label': '$22.8k - $28.5k', 'value': 7},
                {'label': '$28.5k - $34.2k', 'value': 5},
                {'label': '$34.2k - $39.9k', 'value': 3},
                {'label': '$39.9k - $45.7k', 'value': 5},
                {'label': '$45.7k - $51.4k', 'value': 4},
                {'label': '$51.4k - $1.8m', 'value': 36}],
            'UI Router': [{'label': '$0.00 - $341.11', 'value': 135},
                {'label': '$341.11 - $682.23', 'value': 31},
                {'label': '$682.23 - $1.0k', 'value': 23},
                {'label': '$1.0k - $1.4k', 'value': 10},
                {'label': '$1.4k - $1.7k', 'value': 5},
                {'label': '$1.7k - $2.0k', 'value': 6},
                {'label': '$2.0k - $2.4k', 'value': 4},
                {'label': '$2.4k - $2.7k', 'value': 2},
                {'label': '$2.7k - $3.1k', 'value': 6},
                {'label': '$3.1k - $809.8k', 'value': 43}]
        },
        'base': {
            'Trading': [{'label': '$0.00 - $2.2k', 'value': 209},
                {'label': '$2.2k - $4.4k', 'value': 58},
                {'label': '$4.4k - $6.7k', 'value': 31},
                {'label': '$6.7k - $8.9k', 'value': 19},
                {'label': '$8.9k - $11.1k', 'value': 3},
                {'label': '$11.1k - $13.3k', 'value': 2},
                {'label': '$13.3k - $15.5k', 'value': 6},
                {'label': '$15.5k - $17.8k', 'value': 5},
                {'label': '$17.8k - $20.0k', 'value': 2},
                {'label': '$20.0k - $41.1m', 'value': 82}],
            'LP': [{'label': '$0.00 - $123.58', 'value': 1344},
                {'label': '$123.58 - $247.15', 'value': 161},
                {'label': '$247.15 - $370.73', 'value': 75},
                {'label': '$370.73 - $494.31', 'value': 33},
                {'label': '$494.31 - $617.89', 'value': 32},
                {'label': '$617.89 - $741.46', 'value': 20},
                {'label': '$741.46 - $865.04', 'value': 14},
                {'label': '$865.04 - $988.62', 'value': 17},
                {'label': '$988.62 - $1.1k', 'value': 32},
                {'label': '$1.1k - $1.4m', 'value': 398}],
            'UI Router': [{'label': '$0.00 - $19.71', 'value': 10961},
                {'label': '$19.71 - $39.42', 'value': 2944},
                {'label': '$39.42 - $59.13', 'value': 876},
                {'label': '$59.13 - $78.84', 'value': 634},
                {'label': '$78.84 - $98.54', 'value': 334},
                {'label': '$98.54 - $118.25', 'value': 414},
                {'label': '$118.25 - $137.96', 'value': 508},
                {'label': '$137.96 - $157.67', 'value': 227},
                {'label': '$157.67 - $177.38', 'value': 197},
                {'label': '$177.38 - $2.1m', 'value': 3370}]
        },
        'arbitrum': {
            'Trading': [{'label': '$0.00 - $925.07', 'value': 3152},
                {'label': '$925.07 - $1.9k', 'value': 413},
                {'label': '$1.9k - $2.8k', 'value': 160},
                {'label': '$2.8k - $3.7k', 'value': 116},
                {'label': '$3.7k - $4.6k', 'value': 101},
                {'label': '$4.6k - $5.6k', 'value': 66},
                {'label': '$5.6k - $6.5k', 'value': 74},
                {'label': '$6.5k - $7.4k', 'value': 55},
                {'label': '$7.4k - $8.3k', 'value': 50},
                {'label': '$8.3k - $478.6m', 'value': 899}],
            'LP': [{'label': '$0.00 - $7.6k', 'value': 3175},
                {'label': '$7.6k - $15.3k', 'value': 389},
                {'label': '$15.3k - $22.9k', 'value': 239},
                {'label': '$22.9k - $30.6k', 'value': 137},
                {'label': '$30.6k - $38.2k', 'value': 68},
                {'label': '$38.2k - $45.9k', 'value': 94},
                {'label': '$45.9k - $53.5k', 'value': 70},
                {'label': '$53.5k - $61.2k', 'value': 64},
                {'label': '$61.2k - $68.8k', 'value': 37},
                {'label': '$68.8k - $154.2m', 'value': 910}],
            'UI Router': [{'label': '$0.00 - $647.15', 'value': 7085},
                {'label': '$647.15 - $1.3k', 'value': 766},
                {'label': '$1.3k - $1.9k', 'value': 415},
                {'label': '$1.9k - $2.6k', 'value': 334},
                {'label': '$2.6k - $3.2k', 'value': 206},
                {'label': '$3.2k - $3.9k', 'value': 153},
                {'label': '$3.9k - $4.5k', 'value': 147},
                {'label': '$4.5k - $5.2k', 'value': 142},
                {'label': '$5.2k - $5.8k', 'value': 88},
                {'label': '$5.8k - $12.9m', 'value': 2015}],
            'Lend': [{'label': '$0.29 - $63.7k', 'value': 293},
                {'label': '$63.7k - $127.3k', 'value': 39},
                {'label': '$127.3k - $191.0k', 'value': 22},
                {'label': '$191.0k - $254.6k', 'value': 14},
                {'label': '$254.6k - $318.3k', 'value': 17},
                {'label': '$318.3k - $381.9k', 'value': 5},
                {'label': '$381.9k - $445.6k', 'value': 10},
                {'label': '$445.6k - $509.3k', 'value': 2},
                {'label': '$509.3k - $572.9k', 'value': 7},
                {'label': '$572.9k - $6.8b', 'value': 76}]
        },
        'all': {
            'Trading': [{'label': '$0.00 - $2.4k', 'value': 20638},
                {'label': '$2.4k - $4.8k', 'value': 2583},
                {'label': '$4.8k - $7.2k', 'value': 1496},
                {'label': '$7.2k - $9.6k', 'value': 935},
                {'label': '$9.6k - $12.0k', 'value': 939},
                {'label': '$12.0k - $14.4k', 'value': 414},
                {'label': '$14.4k - $16.8k', 'value': 523},
                {'label': '$16.8k - $19.1k', 'value': 264},
                {'label': '$19.1k - $21.5k', 'value': 397},
                {'label': '$21.5k - $11.7b', 'value': 5743}],
            'LP': [{'label': '$0.00 - $2.2k', 'value': 23100},
                {'label': '$2.2k - $4.4k', 'value': 3870},
                {'label': '$4.4k - $6.6k', 'value': 2189},
                {'label': '$6.6k - $8.9k', 'value': 1332},
                {'label': '$8.9k - $11.1k', 'value': 1042},
                {'label': '$11.1k - $13.3k', 'value': 668},
                {'label': '$13.3k - $15.5k', 'value': 598},
                {'label': '$15.5k - $17.7k', 'value': 380},
                {'label': '$17.7k - $19.9k', 'value': 329},
                {'label': '$19.9k - $594.4m', 'value': 6754}],
            'UI Router': [{'label': '$0.00 - $1.0k', 'value': 40753},
                {'label': '$1.0k - $2.0k', 'value': 3691},
                {'label': '$2.0k - $3.0k', 'value': 2153},
                {'label': '$3.0k - $4.0k', 'value': 1555},
                {'label': '$4.0k - $5.0k', 'value': 1010},
                {'label': '$5.0k - $6.0k', 'value': 920},
                {'label': '$6.0k - $7.0k', 'value': 760},
                {'label': '$7.0k - $8.0k', 'value': 589},
                {'label': '$8.0k - $9.0k', 'value': 408},
                {'label': '$9.0k - $359.0m', 'value': 11683}],
            'crvUSD': [{'label': '$0.04 - $506.3k', 'value': 1524},
                {'label': '$506.3k - $1.0m', 'value': 255},
                {'label': '$1.0m - $1.5m', 'value': 174},
                {'label': '$1.5m - $2.0m', 'value': 111},
                {'label': '$2.0m - $2.5m', 'value': 93},
                {'label': '$2.5m - $3.0m', 'value': 55},
                {'label': '$3.0m - $3.5m', 'value': 36},
                {'label': '$3.5m - $4.1m', 'value': 33},
                {'label': '$4.1m - $4.6m', 'value': 28},
                {'label': '$4.6m - $9.0b', 'value': 387}],
            'Lend': [{'label': '$0.29 - $94.9k', 'value': 477},
                {'label': '$94.9k - $189.7k', 'value': 58},
                {'label': '$189.7k - $284.6k', 'value': 33},
                {'label': '$284.6k - $379.4k', 'value': 26},
                {'label': '$379.4k - $474.3k', 'value': 19},
                {'label': '$474.3k - $569.1k', 'value': 14},
                {'label': '$569.1k - $664.0k', 'value': 9},
                {'label': '$664.0k - $758.9k', 'value': 9},
                {'label': '$758.9k - $853.7k', 'value': 8},
                {'label': '$853.7k - $6.8b', 'value': 132}]
        }
    };



const productList = ["Trading", "LP", "UI Router", "crvUSD", "Lend"];

let histogramChart;

function createProductSelector(elementId, onChangeCallback) {
    const selectElement = document.getElementById(elementId);
    if (!selectElement) {
        console.error(`Element with id "${elementId}" not found`);
        return null;
    }

    selectElement.innerHTML = ''; // Clear existing options

    productList.forEach(product => {
        const option = document.createElement('option');
        option.value = product;
        option.textContent = product;
        selectElement.appendChild(option);
    });

    selectElement.addEventListener('change', (event) => {
        onChangeCallback(event.target.value);
    });

    return selectElement.value;
}

function createHistogramChart(chainData, product) {
    const ctx = document.getElementById('histogramChart').getContext('2d');

    if (histogramChart) {
        histogramChart.destroy();
    }

    if (!chainData || !chainData[product]) {
        displayErrorMessage(`No data available for ${product} on this chain.`);
        return;
    }

    const labels = chainData[product].map(item => item.label);
    const values = chainData[product].map(item => item.value);

    histogramChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: `${product} Volume Distribution`,
                data: values,
                backgroundColor: 'rgba(255, 99, 132, 0.6)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Number of Users'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Volume Range'
                    }
                }
            },
            plugins: {
                title: {
                    display: true,
                    text: `${product} Volume Distribution`
                },
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `Users: ${context.parsed.y}`;
                        }
                    }
                }
            }
        }
    });
}

function displayErrorMessage(message) {
    const ctx = document.getElementById('histogramChart').getContext('2d');
    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
    ctx.font = '20px Arial';
    ctx.fillStyle = 'red';
    ctx.textAlign = 'center';
    ctx.fillText(message, ctx.canvas.width / 2, ctx.canvas.height / 2);
}

function updateHistogramChart(selectedChain, selectedProduct) {
    if (selectedProduct === 'crvUSD' && selectedChain !== 'ethereum' && selectedChain !== 'all') {
        displayErrorMessage('crvUSD is only available on Ethereum.');
    } else if (selectedProduct === 'Lend' && !['ethereum', 'arbitrum', 'all'].includes(selectedChain)) {
        displayErrorMessage('Lend is only available on Ethereum and Arbitrum.');
    } else if (histogramData[selectedChain] && histogramData[selectedChain][selectedProduct]) {
        createHistogramChart(histogramData[selectedChain], selectedProduct);
    } else {
        createHistogramChart(histogramData[selectedChain], selectedProduct);

      //  displayErrorMessage(`Data not available for chain: ${selectedChain}, product: ${selectedProduct}`);
    }
}

function updateProductSelector(selectedChain) {
    const productSelect = document.getElementById('productSelectHistogram');
    productSelect.innerHTML = '';

    productList.forEach(product => {
        if (product === 'crvUSD' && selectedChain !== 'ethereum' && selectedChain !== 'all') {
            return;
        }
        if (product === 'Lend' && !['ethereum', 'arbitrum', 'all'].includes(selectedChain)) {
            return;
        }
        const option = document.createElement('option');
        option.value = product;
        option.textContent = product;
        productSelect.appendChild(option);
    });

    // Ensure "Trading" is always available and selected by default
    if (!productSelect.querySelector('option[value="Trading"]')) {
        const tradingOption = document.createElement('option');
        tradingOption.value = 'Trading';
        tradingOption.textContent = 'Trading';
        productSelect.insertBefore(tradingOption, productSelect.firstChild);
    }
    productSelect.value = 'Trading';
}

document.addEventListener('DOMContentLoaded', () => {
    const chainSelect = document.getElementById('chainSelectHistogram');
    const productSelect = document.getElementById('productSelectHistogram');

    // Initialize chain selector
    const initialChain = createChainSelector('chainSelectHistogram', (chain) => {
        updateProductSelector(chain);
        updateHistogramChart(chain, productSelect.value);
    });

    // Initialize product selector
    createProductSelector('productSelectHistogram', (product) => {
        updateHistogramChart(chainSelect.value, product);
    });

    // Set default values
    chainSelect.value = initialChain || 'all';
    updateProductSelector(chainSelect.value);
    productSelect.value = 'Trading';  // Set "Trading" as default

    // Initial chart update
    updateHistogramChart(chainSelect.value, productSelect.value);
});

